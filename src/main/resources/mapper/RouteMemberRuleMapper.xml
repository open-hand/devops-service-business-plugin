<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="io.choerodon.iam.infra.mapper.RouteMemberRuleProMapper">
    <select id="listUserRoleByOrgId" resultType="io.choerodon.iam.infra.dto.RouteMemberRuleDTO">
        SELECT
            imr.id, imr.role_id, imr.member_id, imr.member_type, imr.source_id, imr.source_type
        FROM iam_member_role imr
        LEFT JOIN iam_role ir ON imr.role_id = ir.id
        WHERE imr.member_id = #{userId} AND imr.member_type = 'user'
            AND imr.source_id = #{organzationId} AND imr.source_type = 'organization'
            AND ir.code IN
        <foreach collection="roleCodes" item="roleCode" open="(" close=")" separator="," index="i">
            #{roleCode}
        </foreach>
    </select>
</mapper>
